2<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lecture 24: Extra Map Info - CSCI 3213</title>
    
    <!-- OCU Branded Presentation Styles with Theme Support -->
    <link rel="stylesheet" href="../../styles/presentation.css">
    <link rel="icon" type="image/x-icon" href="/images/favicon.png">
    
    <!-- Lecture-Specific Styles -->
    <style>
        .hud-demo {
            background: #1a1a2e;
            color: #0f0;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            border: 2px solid #16213e;
        }
        
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: var(--card-bg, #f8f8f8);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid var(--border-color, #ddd);
            transition: transform 0.3s;
        }
        
        .metric-card:hover {
            transform: scale(1.05);
        }
        
        .code-showcase {
            background: #2d2d2d;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            border-left: 4px solid #00ff00;
            overflow-x: auto;
        }
        
        .godot-tip {
            background: var(--ocu-cyan);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 5px solid var(--ocu-true-blue);
        }
        
        .hud-corner-visual {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 10px;
            margin: 20px auto;
            max-width: 600px;
            height: 400px;
            border: 3px solid var(--ocu-true-blue);
            border-radius: 8px;
            padding: 10px;
            background: var(--bg-secondary);
        }
        
        .hud-corner {
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            font-weight: bold;
            color: var(--ocu-cyan);
        }
        
        .hud-top-left {
            align-items: flex-start;
            justify-content: flex-start;
        }
        
        .hud-top-right {
            align-items: flex-start;
            justify-content: flex-end;
        }
        
        .hud-bottom-left {
            align-items: flex-end;
            justify-content: flex-start;
        }
        
        .hud-bottom-right {
            align-items: flex-end;
            justify-content: flex-end;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .before-after {
            padding: 15px;
            border-radius: 8px;
        }
        
        .before {
            background: #ffe6e6;
            border-left: 4px solid #ff4444;
        }
        
        .after {
            background: #e6ffe6;
            border-left: 4px solid #44ff44;
        }
    </style>
</head>
<body>
    
    <div class="presentation-container">
        <!-- Timer display -->
        <div class="timer-display" id="timer-display">
            <span id="timer-text">Lecture 24: Extra Map Info - HUD Metrics
                 <button class="home"><a href="../../index.html">Home</a></button>
            </span>
        </div>

        <!-- Slide 1: Title -->
        <div class="slide active">
            <h1>Extra Map Info</h1>
            <h2>Detector Count & Travel Distance <span class="emoji">üìä</span></h2>
            <p style="font-size: 1.5em; margin-top: 40px;">CSCI 3213 - Game Programming</p>
            <p style="font-size: 1.3em;">Spring '26 - Week 8, Class 2</p>
            <p style="margin-top: auto; font-style: italic;">Tracking player progress and performance!</p>
        </div>

        <!-- Slide 2: Learning Objectives -->
        <div class="slide">
            <h1>Today's Quest Objectives</h1>
            <ul style="font-size: 1.4em; line-height: 2;">
                <li>üéØ Add detector count tracking to HUD</li>
                <li>üìè Implement travel distance measurement</li>
                <li>üèÜ Create best score tracking system</li>
                <li>üíæ Store multiple performance metrics</li>
                <li>üé® Design informative HUD layouts</li>
            </ul>
            <div class="demo-box" style="margin-top: 40px;">
                <p><strong>Tutorial:</strong> Extra Map Info (Tutorial #10)</p>
                <p><strong>Engine:</strong> Godot 4.4</p>
            </div>
        </div>

        <!-- Slide 3: Why Track Metrics? -->
        <div class="slide">
            <h1>Why Track Game Metrics? <span class="emoji">üìà</span></h1>
            <div class="metric-grid">
                <div class="metric-card">
                    <h3>Player Feedback</h3>
                    <p>Show progress clearly</p>
                </div>
                <div class="metric-card">
                    <h3>Completion Goals</h3>
                    <p>Give players targets</p>
                </div>
                <div class="metric-card">
                    <h3>Replayability</h3>
                    <p>Encourage optimization</p>
                </div>
                <div class="metric-card">
                    <h3>Skill Measurement</h3>
                    <p>Track improvement</p>
                </div>
            </div>
            <div class="godot-tip">
                <strong>Design Principle:</strong> Good metrics reinforce player progress and create additional challenges for skilled players!
            </div>
        </div>

        <!-- Slide 4: HUD Corner Layout -->
        <div class="slide">
            <h1>Four-Corner HUD Design</h1>
            <div class="hud-corner-visual">
                <div class="hud-corner hud-top-left">Map Name<br>Map Time</div>
                <div class="hud-corner hud-top-right">New Best!</div>
                <div class="hud-corner hud-bottom-left">Travel: 0px</div>
                <div class="hud-corner hud-bottom-right">00 / 00 Detectors</div>
            </div>
            <p style="text-align: center; margin-top: 20px;">
                All four corners contain relevant information without cluttering the center view
            </p>
        </div>

        <!-- Slide 5: Detector Count Implementation -->
        <div class="slide">
            <h1>Detector Count Display</h1>
            <h3>Step 1: Add Label to HUD</h3>
            <ul>
                <li>Duplicate the map time label in hud.tscn</li>
                <li>Set Anchors Preset to <strong>Bottom Right</strong></li>
                <li>Position X: 324 (one-tile margin)</li>
                <li>Default text: "00 / 00"</li>
            </ul>
            <div class="code-showcase">
@export var map_detector_count_label: Label

func show_map_detector_count(valid: int, total: int) -> void:
    map_detector_count_label.text = "%d / %d" % [valid, total]
            </div>
            <div class="godot-tip">
                <strong>String Formatting:</strong> Use <code>%d</code> for integers. Multiple values need an array!
            </div>
        </div>

        <!-- Slide 6: Updating Detector Count -->
        <div class="slide">
            <h1>Keeping Detector Count Current</h1>
            <h3>Two Update Points:</h3>
            <div class="comparison-grid">
                <div class="before-after before">
                    <h4>1. On Map Load</h4>
                    <div class="code-showcase" style="background: #2d2d2d;">
func _ready() -> void:
    # ... existing code ...
    Main.map_loaded(self)
    HUD.show_map_info(self)
    HUD.show_map_detector_count(
        valid_detector_count,
        registered_detector_count
    )
                    </div>
                </div>
                <div class="before-after after">
                    <h4>2. On Detector Change</h4>
                    <div class="code-showcase" style="background: #2d2d2d;">
func _on_detector_validity_changed(valid: bool) -> void:
    if valid:
        valid_detector_count += 1
    else:
        valid_detector_count -= 1
    
    HUD.show_map_detector_count(
        valid_detector_count,
        registered_detector_count
    )
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 7: Travel Distance Concept -->
        <div class="slide">
            <h1>Measuring Travel Distance <span class="emoji">üìè</span></h1>
            <h3>The Challenge:</h3>
            <p style="font-size: 1.2em;">How do we measure how far the player has moved?</p>
            <div class="demo-box">
                <h4>Solution: Track Position Changes</h4>
                <ol style="text-align: left; font-size: 1.1em;">
                    <li>Store the last position</li>
                    <li>Calculate distance from last position to current</li>
                    <li>Add to cumulative distance</li>
                    <li>Update last position</li>
                </ol>
            </div>
            <div class="godot-tip">
                <strong>Physics Insight:</strong> We calculate distance in pixels using Vector2.distance_to()
            </div>
        </div>

        <!-- Slide 8: Travel Distance Variables -->
        <div class="slide">
            <h1>Setting Up Distance Tracking</h1>
            <h3>In player_character.gd:</h3>
            <div class="code-showcase">
var last_position: Vector2
var travel_distance := 0.0

func _ready() -> void:
    last_position = position
    HUD.show_travel_distance(travel_distance)
            </div>
            <h3>In hud.gd:</h3>
            <div class="code-showcase">
@export var travel_distance_label: Label

func show_travel_distance(distance: float) -> void:
    travel_distance_label.text = "%dpx" % distance
            </div>
        </div>

        <!-- Slide 9: Calculating Distance -->
        <div class="slide">
            <h1>Distance Calculation in Physics Process</h1>
            <div class="code-showcase">
func _physics_process(_delta: float) -> void:
    get_player_input()
    if move_and_slide():
        resolve_collisions()
    
    travel_distance += last_position.distance_to(position)
    last_position = position

func _process(_delta: float) -> void:
    HUD.show_travel_distance(travel_distance)
            </div>
            <div class="godot-tip">
                <strong>Optimization:</strong> Update physics every physics frame, but only update display every visual frame!
            </div>
        </div>

        <!-- Slide 10: Best Scores System -->
        <div class="slide">
            <h1>Tracking Best Performance <span class="emoji">üèÜ</span></h1>
            <h3>Two Metrics to Track:</h3>
            <div class="metric-grid">
                <div class="metric-card" style="border-color: #ffd700;">
                    <h3>Best Time</h3>
                    <p>Fastest completion</p>
                    <p style="font-size: 2em;">‚è±Ô∏è</p>
                </div>
                <div class="metric-card" style="border-color: #ffd700;">
                    <h3>Best Distance</h3>
                    <p>Shortest path</p>
                    <p style="font-size: 2em;">üìè</p>
                </div>
            </div>
            <p style="text-align: center; margin-top: 30px; font-size: 1.2em;">
                These metrics are <strong>independent</strong> - you can improve one without improving the other!
            </p>
        </div>

        <!-- Slide 11: Best Score Data Keys -->
        <div class="slide">
            <h1>Storing Best Scores</h1>
            <h3>Add New Key for Distance:</h3>
            <div class="code-showcase">
const KEY_BEST_TIME := "best_time"
const KEY_BEST_TRAVEL_DISTANCE := "best_travel_distance"
            </div>
            <div class="godot-tip">
                <strong>Data Design:</strong> Use clear, descriptive constant names for save data keys to avoid typos!
            </div>
            <h3>Storage Location:</h3>
            <p style="font-size: 1.2em; margin-top: 20px;">
                Both metrics saved in <code>map_save_data</code> dictionary
            </p>
        </div>

        <!-- Slide 12: Update Best Scores Function -->
        <div class="slide">
            <h1>_update_best_scores() Function</h1>
            <div class="code-showcase" style="font-size: 0.85em;">
func _update_best_scores() -> void:
    # Check and update best time
    var new_time := floori(current_map_time)
    if (not map_save_data.has(KEY_BEST_TIME)
            or new_time < map_save_data[KEY_BEST_TIME]):
        map_save_data[KEY_BEST_TIME] = new_time
    else:
        new_time = -1  # Not a new best
    
    # Check and update best travel distance
    var new_travel_distance := floori(player_character.travel_distance)
    if (not map_save_data.has(KEY_BEST_TRAVEL_DISTANCE)
            or new_travel_distance < map_save_data[KEY_BEST_TRAVEL_DISTANCE]):
        map_save_data[KEY_BEST_TRAVEL_DISTANCE] = new_travel_distance
    else:
        new_travel_distance = -1  # Not a new best
    
    HUD.show_new_best_map_scores(new_time, new_travel_distance)
            </div>
        </div>

        <!-- Slide 13: Finding the Player Character -->
        <div class="slide">
            <h1>Accessing Player from Map <span class="emoji">üîç</span></h1>
            <h3>Using Class Names:</h3>
            <div class="code-showcase">
# In player_character.gd:
class_name PlayerCharacter
extends CharacterBody2D

# In map.gd:
var player_character: PlayerCharacter

func _ready() -> void:
    for child_node in get_children():
        var detector := child_node as Detector
        if detector:
            registered_detector_count += 1
            detector.validity_changed.connect(_on_detector_validity_changed)
        else:
            var pc := child_node as PlayerCharacter
            if pc:
                player_character = pc
            </div>
        </div>

        <!-- Slide 14: Four Score Display Scenarios -->
        <div class="slide">
            <h1>Smart Score Display Logic</h1>
            <h3>Four Possible Outcomes:</h3>
            <div class="metric-grid">
                <div class="metric-card">
                    <p>‚úÖ New best time</p>
                    <p>‚úÖ New best distance</p>
                </div>
                <div class="metric-card">
                    <p>‚úÖ New best time</p>
                    <p>‚ùå No new best distance</p>
                </div>
                <div class="metric-card">
                    <p>‚ùå No new best time</p>
                    <p>‚úÖ New best distance</p>
                </div>
                <div class="metric-card">
                    <p>‚ùå No new best time</p>
                    <p>‚ùå No new best distance</p>
                </div>
            </div>
            <div class="godot-tip">
                <strong>Design Pattern:</strong> Use -1 to indicate "no new best" and handle all cases!
            </div>
        </div>

        <!-- Slide 15: Display Logic Implementation -->
        <div class="slide">
            <h1>Conditional Score Display</h1>
            <div class="code-showcase" style="font-size: 0.8em;">
## Show new best scores, supply -1 to indicate no new best score.
func show_new_best_map_scores(time: int, travel_distance: int) -> void:
    var s: String
    if time >= 0:
        if travel_distance >= 0:
            s = ("New best time: %ds\nNew best travel distance: %dpx" %
                 [time, travel_distance])
        else:
            s = "New best time: %ds" % time
    elif travel_distance >= 0:
        s = "New best travel distance: %dpx" % travel_distance
    else:
        return  # No new best scores, don't display anything
    
    new_best_map_scores_label.text = s
    new_best_map_scores_label.visible = true
            </div>
        </div>

        <!-- Slide 16: String Formatting with Newlines -->
        <div class="slide">
            <h1>Multi-Line Text Display</h1>
            <h3>Using Escape Sequences:</h3>
            <div class="code-showcase">
# Single line:
"New best time: %ds" % time

# Multiple lines with \n:
"New best time: %ds\nNew best travel distance: %dpx" % [time, distance]
            </div>
            <div class="demo-box">
                <p style="font-size: 1.3em;"><strong>Result:</strong></p>
                <p style="margin-top: 10px;">New best time: 45s</p>
                <p>New best travel distance: 1250px</p>
            </div>
            <div class="godot-tip">
                <strong>Typography:</strong> \n creates a line break. Set Label alignment to "Center" for best appearance!
            </div>
        </div>

        <!-- Slide 17: Label Configuration -->
        <div class="slide">
            <h1>HUD Label Setup Checklist</h1>
            <h3>For Detector Count Label:</h3>
            <ul style="font-size: 1.2em;">
                <li>‚úì Anchors Preset: <strong>Bottom Right</strong></li>
                <li>‚úì Position X: <strong>324</strong></li>
                <li>‚úì Default Text: <strong>"00 / 00"</strong></li>
            </ul>
            <h3 style="margin-top: 30px;">For Travel Distance Label:</h3>
            <ul style="font-size: 1.2em;">
                <li>‚úì Anchors Preset: <strong>Bottom Left</strong></li>
                <li>‚úì Position X: <strong>16</strong></li>
                <li>‚úì Default Text: <strong>"0px"</strong></li>
            </ul>
        </div>

        <!-- Slide 18: Code Documentation -->
        <div class="slide">
            <h1>Documenting Your Code <span class="emoji">üìù</span></h1>
            <h3>Using GDScript Comments:</h3>
            <div class="code-showcase">
## Show new best scores, supply -1 to indicate no new best score.
func show_new_best_map_scores(time: int, travel_distance: int) -> void:
    # Implementation here...
            </div>
            <div class="godot-tip">
                <strong>Best Practice:</strong> Double hash (##) creates documentation comments that appear in autocomplete!
            </div>
            <p style="margin-top: 30px; font-size: 1.2em;">
                Good documentation explains <em>why</em> and <em>how</em>, not just <em>what</em>
            </p>
        </div>

        <!-- Slide 19: Physics vs Visual Updates -->
        <div class="slide">
            <h1>Process vs Physics Process</h1>
            <div class="comparison-grid">
                <div class="metric-card">
                    <h3>_physics_process()</h3>
                    <ul style="text-align: left; font-size: 1.1em;">
                        <li>Fixed timestep</li>
                        <li>60 FPS default</li>
                        <li>Calculate distance</li>
                        <li>Movement logic</li>
                    </ul>
                </div>
                <div class="metric-card">
                    <h3>_process()</h3>
                    <ul style="text-align: left; font-size: 1.1em;">
                        <li>Every frame</li>
                        <li>Variable rate</li>
                        <li>Update displays</li>
                        <li>Visual feedback</li>
                    </ul>
                </div>
            </div>
            <div class="godot-tip">
                <strong>Performance Tip:</strong> Don't update UI elements more often than they're rendered!
            </div>
        </div>

        <!-- Slide 20: Testing Checklist -->
        <div class="slide">
            <h1>Testing Your Metrics <span class="emoji">üß™</span></h1>
            <h3>Verify These Behaviors:</h3>
            <ul style="font-size: 1.3em; line-height: 2;">
                <li>‚úì Detector count updates when stepping on plates</li>
                <li>‚úì Travel distance increases as player moves</li>
                <li>‚úì Best time saves correctly</li>
                <li>‚úì Best distance saves correctly</li>
                <li>‚úì Can get new best time without new best distance</li>
                <li>‚úì Can get new best distance without new best time</li>
                <li>‚úì All four HUD corners display properly</li>
            </ul>
        </div>

        <!-- Slide 21: Common Mistakes -->
        <div class="slide">
            <h1>Common Pitfalls to Avoid <span class="emoji">‚ö†Ô∏è</span></h1>
            <div class="comparison-grid">
                <div class="before-after before">
                    <h4>‚ùå Wrong</h4>
                    <div class="code-showcase" style="background: #3d2020;">
# Forgetting the array for multiple values:
text = "%d / %d" % valid, total

# Not resetting last_position:
travel_distance += position.length()

# Updating HUD in physics_process:
func _physics_process(_delta):
    HUD.show_travel_distance(travel_distance)
                    </div>
                </div>
                <div class="before-after after">
                    <h4>‚úÖ Correct</h4>
                    <div class="code-showcase" style="background: #203d20;">
# Use array for multiple placeholders:
text = "%d / %d" % [valid, total]

# Calculate distance between positions:
travel_distance += last_position.distance_to(position)

# Update visual displays in _process:
func _process(_delta):
    HUD.show_travel_distance(travel_distance)
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 22: Design Considerations -->
        <div class="slide">
            <h1>Game Design Insights <span class="emoji">üéÆ</span></h1>
            <h3>Why These Metrics Matter:</h3>
            <div class="metric-grid">
                <div class="metric-card">
                    <h4>Speed Runs</h4>
                    <p>Best time encourages quick, efficient play</p>
                </div>
                <div class="metric-card">
                    <h4>Optimization</h4>
                    <p>Best distance rewards path planning</p>
                </div>
                <div class="metric-card">
                    <h4>Replayability</h4>
                    <p>Multiple goals = more reasons to replay</p>
                </div>
                <div class="metric-card">
                    <h4>Player Types</h4>
                    <p>Different challenges appeal to different players</p>
                </div>
            </div>
        </div>

        <!-- Slide 23: Extension Ideas -->
        <div class="slide">
            <h1>Taking It Further <span class="emoji">üöÄ</span></h1>
            <h3>Additional Metrics You Could Track:</h3>
            <ul style="font-size: 1.3em; line-height: 2;">
                <li>üí∞ Collectibles gathered</li>
                <li>‚öîÔ∏è Enemies defeated</li>
                <li>üíî Damage taken</li>
                <li>üîÑ Number of retries</li>
                <li>‚≠ê Perfect completion bonuses</li>
                <li>üìä Global leaderboards</li>
            </ul>
            <div class="godot-tip">
                <strong>Challenge:</strong> What metrics would make YOUR game more engaging?
            </div>
        </div>

        <!-- Slide 24: Key Takeaways -->
        <div class="slide">
            <h1>Key Takeaways <span class="emoji">üéØ</span></h1>
            <ul style="font-size: 1.3em; line-height: 2;">
                <li>üìä Metrics provide player feedback and goals</li>
                <li>üé® Good HUD design uses screen corners efficiently</li>
                <li>üìè Vector2.distance_to() calculates movement</li>
                <li>üíæ Independent metrics allow multiple optimization paths</li>
                <li>‚öôÔ∏è Separate physics calculations from visual updates</li>
                <li>üèÜ -1 is a useful sentinel value for "no update"</li>
            </ul>
        </div>

        <!-- Slide 25: Homework -->
        <div class="slide">
            <h1>Mission Assignment <span class="emoji">üìã</span></h1>
            <div class="demo-box">
                <h2>Your Quest:</h2>
                <p style="font-size: 1.3em; margin: 20px 0;">
                    Continue working on your semester game project!
                </p>
                <h3>Consider Adding:</h3>
                <ul style="text-align: left; font-size: 1.2em;">
                    <li>Progress tracking metrics relevant to your game</li>
                    <li>A comprehensive HUD with useful information</li>
                    <li>Best score tracking for replayability</li>
                    <li>Player performance feedback</li>
                </ul>
                <p style="margin-top: 30px; font-size: 1.1em;">
                    <strong>Due:</strong> End of semester as part of final project
                </p>
            </div>
        </div>

        <!-- Slide 26: Resources -->
        <div class="slide">
            <h1>Additional Resources <span class="emoji">üìö</span></h1>
            <div class="metric-grid">
                <div class="metric-card">
                    <h3>Tutorial Source</h3>
                    <p>Extra Map Info</p>
                    <p>Published 2025-09-05</p>
                </div>
                <div class="metric-card">
                    <h3>Godot Docs</h3>
                    <p>UI and HUD Systems</p>
                    <p>Label Formatting</p>
                </div>
                <div class="metric-card">
                    <h3>Game Design</h3>
                    <p>Metrics & Analytics</p>
                    <p>Player Feedback</p>
                </div>
                <div class="metric-card">
                    <h3>Previous Tutorials</h3>
                    <p>Game HUD (Tutorial 9)</p>
                    <p>Detectors (Tutorial 7)</p>
                </div>
            </div>
            <p style="text-align: center; margin-top: 30px; font-size: 1.2em;">
                See course repository README for all source materials
            </p>
        </div>

        <!-- Slide 27: Summary -->
        <div class="slide">
            <h1>Achievement Unlocked! <span class="emoji">üèÜ</span></h1>
            <h2>Skills Gained:</h2>
            <ul style="font-size: 1.3em; line-height: 2;">
                <li>‚úÖ Display detector completion metrics</li>
                <li>‚úÖ Track player travel distance</li>
                <li>‚úÖ Implement best score system</li>
                <li>‚úÖ Handle multiple independent metrics</li>
                <li>‚úÖ Design informative game HUDs</li>
                <li>‚úÖ Store and retrieve game statistics</li>
            </ul>
            
            <div class="demo-box" style="margin-top: 30px;">
                <p><strong>Next Quest:</strong> Best scores display and refinement</p>
                <p><strong>Remember:</strong> Good metrics = engaged players!</p>
            </div>
        </div>

        <!-- Navigation Controls -->
        <div class="navigation">
            <button id="prevBtn">Previous</button>
            <span class="slide-counter">
                <span id="currentSlide">1</span> / <span id="totalSlides">27</span>
            </span>
            <button id="nextBtn">Next</button>
        </div>
    </div>

    <!-- Shared Presentation JavaScript -->
    <script src="../../js/presentation.js"></script>

    <!-- Lecture-Specific JavaScript -->
    <script>
        // Listen for slide change events
        document.addEventListener('slidechange', (e) => {
            console.log(`Slide ${e.detail.currentSlide + 1} of ${e.detail.totalSlides}`);
            
            // Could add specific slide behaviors here
            if (e.detail.currentSlide === 3) {
                console.log('Showing HUD layout visualization');
            }
        });
    </script>
</body>
</html>